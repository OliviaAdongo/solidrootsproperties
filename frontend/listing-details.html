<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Property Details</title>
  <!-- Add Bootstrap CSS (or other CSS framework) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h1>Property Details</h1>

    <div class="row">
      <div class="col-md-8">
        <!-- Property Location -->
        <h3>Location: <span id="property-location"></span></h3>

        <!-- Property Images -->
        <div id="property-images" class="mb-4">
          <!-- Images will be loaded here -->
        </div>

        <!-- Property Description -->
        <p><strong>Description:</strong> <span id="property-description"></span></p>

        <!-- Property Category -->
        <p><strong>Category:</strong> <span id="property-category"></span></p>

        <!-- Property Price -->
        <p><strong>Price:</strong> <span id="property-price"></span></p>

        <!-- Property Status -->
        <p><strong>Status:</strong> <span id="property-status"></span></p>

        <!-- Property Agent -->
        <p><strong>Agent:</strong> <span id="property-agent"></span></p>

        <!-- Property Amenities -->
        <p><strong>Amenities:</strong> <span id="property-amenities"></span></p>
      </div>
    </div>
  </div>

  <!-- Add Axios for API calls -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    const getPropertyDetails = async () => {
      const urlParams = new URLSearchParams(window.location.search);
      const propertyId = urlParams.get('id');
      let endpoint;

      // Determine the endpoint based on the property type
      const type = urlParams.get('type'); // Type should be passed as a query parameter (e.g., residential, commercial, land, retail)

      // Update endpoint to match the backend routing
      if (type === 'residential') {
        endpoint = `http://localhost:3000/api/residentialproperties/${propertyId}`;
      } else if (type === 'commercial') {
        endpoint = `http://localhost:3000/api/commercialproperties/${propertyId}`;
      } else if (type === 'land') {
        endpoint = `http://localhost:3000/api/lands/${propertyId}`;
      } else if (type === 'retail') {
        endpoint = `http://localhost:3000/api/retailproperties/${propertyId}`;
      } else {
        console.error('Invalid property type');
        return;
      }

      try {
        const response = await axios.get(endpoint);
        const property = response.data;

        // Display property details
        document.getElementById('property-location').innerText = property.location;
        document.getElementById('property-description').innerText = property.description;
        document.getElementById('property-category').innerText = property.category;
        document.getElementById('property-price').innerText = property.price;
        document.getElementById('property-status').innerText = property.status;
        document.getElementById('property-agent').innerText = property.agent; // Display agent name

        // Check if amenities exist and display
        if (property.amenities && property.amenities.length > 0) {
          document.getElementById('property-amenities').innerText = property.amenities.join(', ');
        } else {
          document.getElementById('property-amenities').innerText = 'No amenities available';
        }

        // Display images
        if (property.images && property.images.length > 0) {
          document.getElementById('property-images').innerHTML = property.images.map(image => `
            <img src="uploads/${image}" alt="Property Image" class="img-fluid mb-3" />
          `).join('');
        } else {
          document.getElementById('property-images').innerText = 'No images available';
        }

      } catch (error) {
        console.error('Error fetching property details:', error);
      }
    };

    window.onload = getPropertyDetails;
  </script>

  <!-- Add Bootstrap JS (optional) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
